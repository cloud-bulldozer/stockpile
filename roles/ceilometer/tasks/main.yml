---
#
# Tasks to get ceilometer facts
#
- name: Check that Ceilometer is installed
  become: true
  stat: path=/etc/ceilometer/ceilometer.conf
  register: ceilometer_config

- name: Parse Ceilometer config
  become: true
  shell: python /tmp/openstack-config-parser.py ceilometer /tmp/out.yml
  when: ceilometer_config.stat.exists
  register: ceilometer_data

- name: display the output
  debug:
    var: ceilometer_data.stdout
